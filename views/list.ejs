<%- include("header"); -%>
<div class="container">
  <div class="box" id="heading">
    <h1>Note App</h1>
  </div>
  <div class="box px-3 py-3">
    <form action="/search" method="POST" class="item">
      <div class="input-group mb-3">
        <input type="text" class="form-control" name="searchTerm" placeholder="Search for items" required>
        <div class="input-group-append">
          <button class="btn btn-outline-secondary px-5 search-btn" type="submit">Search</button>
        </div>
      </div>
    </form>
    <% newListItems.forEach(function(item) { %>
      <div class="item d-flex justify-content-between align-items-center">
        <form action="/delete" method="post" class="d-inline">
          <input type="checkbox" onChange="this.form.submit()" name="checkbox" value="<%= item._id %>">
          <span><%= item.name %></span>
          <input type="hidden" name="listName" value="<%= listTitle %>">
        </form>
        <!-- Update Button -->
        <button type="button" class="btn btn-info btn-sm text-start px-5 py-2" data-toggle="modal" data-target="#updateModal-<%= item._id %>">
          Update
        </button>
      </div>

      <!-- Update Modal -->
      <div class="modal fade" id="updateModal-<%= item._id %>" tabindex="-1" role="dialog" aria-labelledby="updateModalLabel-<%= item._id %>" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="updateModalLabel-<%= item._id %>">Update Item</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <form action="/update" method="POST">
                <div class="form-group">
                  <label for="updatedName-<%= item._id %>">Item Name</label>
                  <input type="text" class="form-control" id="updatedName-<%= item._id %>" name="updatedName" value="<%= item.name %>" required>
                </div>
                <input type="hidden" name="itemId" value="<%= item._id %>">
                <button type="submit" class="btn btn-primary m">Update</button>
              </form>
            </div>
          </div>
        </div>
      </div>
    <% }) %>

    <form class="item mt-3" action="/" method="post">
      <div class="input-group">
        <input type="text" class="form-control" name="newItem" placeholder="New item" autocomplete="off">
        <div class="input-group-append">
          <button type="submit" class="btn btn-success" name="list" value="<%= listTitle %>">+</button>
        </div>
      </div>
    </form>
  </div>
</div>
<%- include("footer"); -%>
